**README**

A simple Deno script that connects to a Discord bot via Harmony, fetches channel
messages, filters by user, and converts results into JSONL format for training
or analysis.

_readme generated by chatgpt_

---

### Setup

1. **Install Deno**\
   [Deno Installation Guide](https://deno.land/#installation)

2. **Set your Discord Bot Token**
   - Create a file named `.env` in the parent directory (or wherever you
     prefer).
   - Inside, set `DISCORD_TOKEN=<YOUR_BOT_TOKEN>`

3. **Project Structure**
   ```
   .
   ├─ handlers.ts          (message fetching / filtering logic)
   ├─ main.ts              (cli script)
   └─ .env                 (environment variables)
   ```

---

### Commands

Run the script using:

```
deno run --allow-all main.ts <command> [args...]
```

**1. Fetch**\
Fetch messages from all channels, skipping a comma-separated list of channel
IDs. Files are saved to a new temp directory each run.

```
deno run --allow-all main.ts fetch 1234567890,9876543210
```

- `1234567890,9876543210` are channel IDs you want to skip.

**2. Filter**\
Filter an existing JSON file by user ID. Writes a new JSON file containing only
that user's messages.

```
deno run --allow-all main.ts filter <USER_ID> <PATH_TO_COMBINED_JSON>
```

- Example:
  `deno run --allow-all main.ts filter 1234567890 /tmp/all-channel-messages.json`

**3. JSONL**\
Convert a JSON file of messages into a JSONL dataset (useful for training
language models).

```
deno run --allow-all main.ts jsonl <PATH_TO_MESSAGES_JSON>
```

- Example: `deno run --allow-all main.ts jsonl /tmp/<USER_ID>-messages.json`

---

### Notes

- Messages are written to a temp directory each run, automatically created and
  printed in the console.
- The combined file `all-channel-messages.json` is only generated by the
  **fetch** command after collecting all channels’ messages.
- Filtered user messages or JSONL outputs are always printed to the same run’s
  temp directory.

Enjoy quick data extraction from your Discord bot and straightforward JSON/JSONL
outputs!
